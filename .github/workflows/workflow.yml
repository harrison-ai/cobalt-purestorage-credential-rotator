name: CI Workflow

on:
  push:

env:
  CI: true

jobs:
  run-tests:
    runs-on: ubuntu-latest
    steps:
      - name: checkout
        uses: actions/checkout@v3

      - name: build dev container
        run: make build-dev

      - name: run formatting checks
        run: make fmt

      - name: run unit tests
        run: make test

      - name: build app container - Build the shippable image
        run: make build-app

      - name: smoketest - Ensure the shippable image has built correctly
        run: make smoketest
